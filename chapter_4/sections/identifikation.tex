\section{Identifikation von Teilnehmern}
\label{subsec:identifikation_von_teilnehmern}

Da es in Peer-to-Peer-Netzwerken keinen zentralen Server gibt, der unter anderem zur Auffindung und Identifikation anderer Teilnehmer verwendet werden kann, müssen die Teilnehmer auf andere Weise identifiziert werden. Durch die Entscheidung, das Kademlia Protokoll zu implementieren, wird die ID des Teilnehmers als Schlüssel für die Speicherung der Teilnehmerinformationen, wie IP-Adresse und Port, verwendet.

Aus der Spezifikation von Kademlia geht hervor, dass die ID einer Node, welche auch als \textit{Kademlia-ID} bezeichnet wird, 160 Bit lang sein muss und aus einer zufälligen Kennung bestehen soll \parencite[S. 2]{Maymounkov_Kademlia}. Für das hier entwickelte Protokoll wird der Benutzername des Teilnehmers als ID verwendet. Da Kademlia eine ID mit einer Länge von 160 Bit erwartet, muss der Benutzername auf diese Länge gebracht werden. Dafür wird eine Zeichenbegrenzung von 20 Zeichen festgelegt, was bei einer UTF-8 Codierung einer Bitlänge von 160 Bit entspricht \parencite{rfc3629_utf-8}. Falls der Benutzername kürzer als 20 Zeichen ist, wird er mit Nullen aufgefüllt.
Der Benutzername muss, wie aus den funktionalen Anforderungen (siehe \ref{subsec:registrierung}) zu entnehmen ist, eindeutig sein und kann vom Benutzer bei der Registrierung frei gewählt werden. 
Durch die Beschränkung der ID auf 20 Zeichen wird die Anzahl der Teilnehmer zwar begrenzt, jedoch ist die Anzahl der möglichen Teilnehmer immer noch sehr groß. Es können in der Theorie $2^{160}$ Teilnehmer am Netzwerk teilnehmen, wobei nicht jedes Zeichen in UTF-8 sinnvoll für die Verwendung in einem Benutzername ist. Somit ist die Anzahl der möglichen Teilnehmer in der Praxis geringer.

Diese Anzahl ist so groß, dass sie in der Praxis nicht erreicht werden sollte und somit die Beschränkung der ID keine Auswirkungen auf die Funktionalität des Protokolls haben sollte.
In der Node werden dann Schlüssel-Wert-Paare gespeichert, wobei der Schlüssel die ID des Teilnehmers ist und der Wert die IP-Adresse und der Port. Es wird festgelegt, dass immer Port $49152$ verwendet wird, da sich dieser Port im Bereich der dynamischen Ports befindet und somit nicht für andere Anwendungen reserviert ist \parencite[S. 20]{rfc6335_IANA_Ports}. 

Wenn ein Teilnehmer eine Nachricht an einen anderen Teilnehmer senden möchte, muss er dessen IP-Adresse kennen. Um an diese Information zu gelangen, muss zuerst die ID des Teilnehmers in der Blockchain gesucht werden und anschließend eine Peer-Discovery durchgeführt werden, um die IP-Adresse des Teilnehmers zu erhalten. Eine Peer-Discovery läuft wie folgt ab:

\begin{enumerate}
    \item Der Teilnehmer, der die Nachricht senden möchte, sendet eine \textit{FIND\_NODE}-Nachricht an den Teilnehmer, dessen IP-Adresse er sucht. In dieser Nachricht ist die ID des Teilnehmers enthalten, dessen IP-Adresse gesucht wird.
    \item Der Teilnehmer, der die Nachricht erhalten hat, sucht in seiner Routing-Tabelle nach dem Teilnehmer, dessen ID in der Nachricht enthalten ist. Falls der Teilnehmer gefunden wird, wird eine Nachricht an den Teilnehmer gesendet, der die \textit{FIND\_NODE}-Nachricht gesendet hat. In dieser Nachricht ist die IP-Adresse des Teilnehmers enthalten.
    \item Falls der Teilnehmer nicht in der Routing-Tabelle gefunden wird, wird die \textit{FIND\_\\NODE}-Nachricht an den Teilnehmer weitergeleitet, der der ID des gesuchten Teilnehmers am nächsten ist. Dieser Vorgang wird solange wiederholt, bis der Teilnehmer gefunden wird.
    \item Falls der Teilnehmer nicht gefunden wird, wird eine \textit{NODE\_NOT\_FOUND}-\\Nachricht an den Teilnehmer gesendet, der die \textit{FIND\_NODE}-Nachricht gesendet hat.
    \item Der Teilnehmer, der die Nachricht mit der IP-Adresse seines Ziels erhalten hat, speichert diese in seiner Routing-Tabelle ab.
\end{enumerate}

\noindent Um das Netzwerk immer aktuell zu halten, wird in regelmäßigen Abständen ein \textit{PING} an alle Teilnehmer gesendet, die in den Routing-Tabellen der Nodes gespeichert sind. Falls ein Teilnehmer nicht antwortet, wird er aus der Routing-Tabelle entfernt.
